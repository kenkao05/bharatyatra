<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin - Travel Spot Submissions</title>
  <style>
    :root{
      --bg-top: #071627; /* deep navy */
      --bg-bottom: #04203a; /* darker navy */
      --card-bg: rgba(255,255,255,0.04);
      --card-border: rgba(255,255,255,0.06);
      --accent: #4FC3FF; /* bright cyan-blue */
      --accent-2: #2B6EA8; /* deeper blue */
      --muted: rgba(200,220,235,0.7);
      --glass: rgba(255,255,255,0.04);
      --radius:14px;
      font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
    }

    html,body{min-height:100%;}
    body{
      margin:0;
      padding:32px 20px;
      color: #E6F4FF;
      background: linear-gradient(180deg, var(--bg-top) 0%, var(--bg-bottom) 100%);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    .back-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      z-index: 10;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.6rem 1rem;
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.02));
      color: var(--muted);
      font-weight: 700;
      border-radius: 999px;
      text-decoration: none;
      box-shadow: 0 6px 24px rgba(6, 18, 35, 0.6), inset 0 1px 0 rgba(255,255,255,0.02);
      transition: all 0.25s ease;
      border: 1px solid var(--card-border);
      backdrop-filter: blur(8px) saturate(120%);
      cursor: pointer;
    }

    .back-btn:hover {
      transform: translateX(-6px);
      color: #FFFFFF;
      box-shadow: 0 10px 30px rgba(43,110,168,0.18), inset 0 1px 0 rgba(255,255,255,0.03);
    }

    .container{
      max-width:1400px;
      margin:0 auto;
    }

    .header{
      margin-bottom:32px;
      padding-right:120px;
    }

    h1{
      margin:0 0 8px 0;
      font-size:30px;
      color:#EAF8FF;
      letter-spacing:0.2px;
    }

    .subtitle{
      color:var(--muted);
      font-size:14px;
      margin:0;
    }

    .filter-bar{
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border-radius:var(--radius);
      padding:14px 18px;
      box-shadow: 0 6px 30px rgba(2,12,25,0.5);
      border:1px solid var(--card-border);
      backdrop-filter: blur(10px) saturate(120%);
      margin-bottom:24px;
      display:flex;
      gap:12px;
      align-items:center;
      flex-wrap:wrap;
    }

    .filter-bar label{
      font-size:13px;
      color:var(--muted);
      font-weight:600;
    }

    .filter-bar select{
      padding:8px 32px 8px 12px;
      border-radius:10px;
      background: rgba(0, 0, 0, 0.03);
      border:1px solid rgba(255,255,255,0.04);
      color: #6db5ec;
      font-size:14px;
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23E6F4FF' d='M6 9L1 4h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
      transition: all 0.2s;
    }

    .filter-bar select:focus{
      outline:none;
      box-shadow:0 6px 20px rgba(43,110,168,0.18);
      border-color: rgba(79,195,255,0.22);
    }

    .submissions-grid{
      display:grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap:20px;
      margin-bottom:40px;
    }

    .submission-card{
      background: var(--card-bg);
      border-radius:var(--radius);
      padding:18px;
      box-shadow: 0 8px 30px rgba(2,12,25,0.6);
      border:1px solid var(--card-border);
      backdrop-filter: blur(10px) saturate(120%);
      transition: all 0.28s ease;
      display:flex;
      flex-direction:column;
      gap:12px;
      color: #E6F4FF;
    }

    .submission-card:hover{
      transform: translateY(-6px);
      box-shadow: 0 20px 60px rgba(2,12,25,0.7), 0 4px 14px rgba(43,110,168,0.12);
    }

    .card-header{
      display:flex;
      justify-content:space-between;
      align-items:start;
      gap:12px;
      padding-bottom:10px;
      border-bottom:1px solid rgba(255,255,255,0.03);
    }

    .card-id{
      font-size:12px;
      color:var(--muted);
      background: rgba(255,255,255,0.02);
      padding:4px 10px;
      border-radius:8px;
      font-weight:700;
      border:1px solid rgba(255,255,255,0.02);
    }

    .card-date{
      font-size:12px;
      color:var(--muted);
    }

    .spot-title{
      font-size:18px;
      font-weight:700;
      color:#F0FAFF;
      margin:8px 0 4px 0;
    }

    .spot-location{
      font-size:13px;
      color:var(--muted);
      display:flex;
      align-items:center;
      gap:8px;
    }

    .location-badge{
      background: rgba(79,195,255,0.08);
      padding:4px 10px;
      border-radius:6px;
      font-size:12px;
      color: #CFF6FF;
      border:1px solid rgba(79,195,255,0.06);
    }

    .spot-description{
      font-size:14px;
      color:#D7F1FF;
      line-height:1.6;
      margin:8px 0;
      max-height:84px;
      overflow:hidden;
      text-overflow:ellipsis;
      display: -webkit-box;
      -webkit-line-clamp: 3;
      line-clamp: 3;
      -webkit-box-orient: vertical;
    }

    .image-section{
      margin:12px 0;
      border-radius:10px;
      overflow:hidden;
      background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
      border:1px solid rgba(255,255,255,0.03);
    }

    .image-section img{
      width:100%;
      height:200px;
      object-fit:cover;
      display:block;
      filter: contrast(0.98) saturate(1.05);
    }

    .no-image{
      width:100%;
      height:200px;
      display:flex;
      align-items:center;
      justify-content:center;
      color:var(--muted);
      font-size:14px;
    }

    .map-link{
      font-size:13px;
      color:var(--accent);
      text-decoration:none;
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:6px 12px;
      background: rgba(43,110,168,0.08);
      border-radius:8px;
      transition: all 0.18s;
      border:1px solid rgba(79,195,255,0.06);
    }

    .map-link:hover{
      background: rgba(79,195,255,0.12);
      transform:translateX(3px);
    }

    .card-actions{
      display:flex;
      gap:10px;
      margin-top:8px;
      padding-top:12px;
      border-top:1px solid rgba(255,255,255,0.03);
    }

    .btn{
      padding:8px 16px;
      border-radius:10px;
      border:0;
      cursor:pointer;
      font-weight:700;
      font-size:13px;
      transition: all 0.25s ease;
      display:inline-flex;
      align-items:center;
      gap:8px;
      text-decoration:none;
      color: #052231;
    }

    .btn-view{
      background: linear-gradient(90deg, var(--accent-2), var(--accent));
      color: white;
      flex:1;
      border:1px solid rgba(255,255,255,0.04);
    }

    .btn-view:hover{
      transform: translateY(-2px);
      box-shadow: 0 8px 30px rgba(43,110,168,0.24);
    }

    .btn-download{
      background: rgba(255,255,255,0.03);
      color: var(--muted);
      border:1px solid rgba(255,255,255,0.03);
    }

    .btn-download:hover{
      background: rgba(255,255,255,0.05);
      transform: translateY(-2px);
    }

    .btn-delete{
      background: rgba(255,80,90,0.06);
      color:#FFB8B8;
      border:1px solid rgba(255,80,90,0.08);
    }

    .btn-delete:hover{
      background: rgba(255,80,90,0.12);
      transform: translateY(-2px);
    }

    .empty-state{
      text-align:center;
      padding:60px 20px;
      color:var(--muted);
    }

    .empty-state-icon{
      font-size:48px;
      margin-bottom:16px;
      opacity:0.6;
    }

    /* Modal for View Details */
    .modal{
      display:none;
      position:fixed;
      top:0;
      left:0;
      width:100%;
      height:100%;
      background:linear-gradient(180deg, rgba(2,6,12,0.6), rgba(2,6,12,0.65));
      backdrop-filter:blur(6px) saturate(120%);
      z-index:100;
      align-items:center;
      justify-content:center;
      padding:20px;
    }

    .modal.active{
      display:flex;
    }

    .modal-content{
      background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));
      border-radius:var(--radius);
      padding:28px;
      max-width:720px;
      width:100%;
      max-height:90vh;
      overflow-y:auto;
      box-shadow: 0 30px 80px rgba(2,12,25,0.75);
      border:1px solid var(--card-border);
      backdrop-filter: blur(14px) saturate(120%);
      color: #EAF8FF;
    }

    .modal-header{
      display:flex;
      justify-content:space-between;
      align-items:start;
      margin-bottom:18px;
      padding-bottom:12px;
      border-bottom:1px solid rgba(255,255,255,0.02);
    }

    .modal-title{
      font-size:22px;
      font-weight:700;
      color:#F0FAFF;
      margin:0;
    }

    .modal-close{
      background:none;
      border:none;
      font-size:28px;
      color:var(--muted);
      cursor:pointer;
      padding:0;
      width:36px;
      height:36px;
      display:flex;
      align-items:center;
      justify-content:center;
      border-radius:8px;
      transition:all 0.2s;
    }

    .modal-close:hover{
      background:rgba(255,255,255,0.02);
      color:#FFFFFF;
    }

    .detail-row{
      margin-bottom:14px;
    }

    .detail-label{
      font-size:12px;
      color:var(--muted);
      font-weight:700;
      text-transform:uppercase;
      letter-spacing:0.5px;
      margin-bottom:6px;
    }

    .detail-value{
      font-size:15px;
      color:#DFF6FF;
      line-height:1.6;
    }

    .modal-image{
      width:100%;
      border-radius:10px;
      margin:16px 0;
      border:1px solid rgba(255,255,255,0.03);
    }

    @media (max-width:768px){
      .submissions-grid{
        grid-template-columns: 1fr;
      }
      .header{
        padding-right:100px;
      }
      .modal-content{
        padding:18px;
      }
    }
  </style>
</head>
<body>
  <a href="../index.html" class="back-btn" id="backBtn">
    ← Back
  </a>

  <div class="container">
    <div class="header">
      <h1>Travel Spot Submissions</h1>
      <p class="subtitle">Review and manage user-submitted travel destinations</p>
    </div>

    <div class="filter-bar">
      <label for="stateFilter">Filter by State:</label>
      <select id="stateFilter">
        <option value="">All States</option>
        <option value="Gujarat">Gujarat</option>
        <option value="Rajasthan">Rajasthan</option>
        <option value="Assam">Assam</option>
        <option value="Jammu and Kashmir">Jammu and Kashmir</option>
        <option value="Kerala">Kerala</option>
      </select>
      <span style="margin-left:auto;font-size:13px;color:var(--muted);" id="resultCount">Loading...</span>
    </div>

    <div class="submissions-grid" id="submissionsGrid">
      <!-- PHP will populate submissions here -->
      <!-- Example structure for PHP loop:
      
      <?php
      // Database connection
      $conn = new mysqli("localhost", "root", "", "your_database_name");
      
      // Check connection
      if ($conn->connect_error) {
          die("Connection failed: " . $conn->connect_error);
      }
      
      // Fetch submissions
      $sql = "SELECT * FROM travel_spots ORDER BY created_at DESC";
      $result = $conn->query($sql);
      
      if ($result->num_rows > 0) {
          while($row = $result->fetch_assoc()) {
              $id = $row['id'];
              $spotName = htmlspecialchars($row['spot_name']);
              $state = htmlspecialchars($row['spot_state']);
              $district = htmlspecialchars($row['spot_district']);
              $description = htmlspecialchars($row['description']);
              $imagePath = $row['image_path'];
              $mapLink = $row['map_link'];
              $createdAt = date('M d, Y', strtotime($row['created_at']));
              
              echo '
              <div class="submission-card" data-state="'.$state.'">
                <div class="card-header">
                  <span class="card-id">#'.$id.'</span>
                  <span class="card-date">'.$createdAt.'</span>
                </div>
                
                <h3 class="spot-title">'.$spotName.'</h3>
                <div class="spot-location">
                  <span class="location-badge">'.$state.'</span>
                  <span class="location-badge">'.$district.'</span>
                </div>
                
                <p class="spot-description">'.$description.'</p>
                
                <div class="image-section">';
                
              if ($imagePath && file_exists($imagePath)) {
                  echo '<img src="'.$imagePath.'" alt="'.$spotName.'">';
              } else {
                  echo '<div class="no-image">No image uploaded</div>';
              }
              
              echo '</div>';
              
              if ($mapLink) {
                  echo '<a href="'.$mapLink.'" target="_blank" class="map-link">📍 View on Maps</a>';
              }
              
              echo '
                <div class="card-actions">
                  <button class="btn btn-view" onclick="viewDetails('.$id.')">View Details</button>';
                  
              if ($imagePath && file_exists($imagePath)) {
                  echo '<a href="'.$imagePath.'" download class="btn btn-download">⬇ Image</a>';
              }
              
              echo '
                  <button class="btn btn-delete" onclick="deleteSubmission('.$id.')">Delete</button>
                </div>
              </div>';
          }
      } else {
          echo '<div class="empty-state">
                  <div class="empty-state-icon">📭</div>
                  <h3>No submissions yet</h3>
                  <p>Travel spot suggestions will appear here</p>
                </div>';
      }
      
      $conn->close();
      ?>
      
      -->
      
      <!-- Demo cards for testing (remove when adding PHP) -->
      <div class="submission-card" data-state="Gujarat">
        <div class="card-header">
          <span class="card-id">#1</span>
          <span class="card-date">Oct 07, 2025</span>
        </div>
        
        <h3 class="spot-title">Statue of Unity</h3>
        <div class="spot-location">
          <span class="location-badge">Gujarat</span>
          <span class="location-badge">Vadodara</span>
        </div>
        
        <p class="spot-description">The world's tallest statue at 182m, dedicated to Sardar Vallabhbhai Patel. Best visited during October-March. Entry fee: ₹120 for adults. Valley of Flowers and boat rides are must-visit attractions nearby.</p>
        
        <div class="image-section">
          <div class="no-image">No image uploaded</div>
        </div>
        
        <a href="https://maps.google.com" target="_blank" class="map-link">📍 View on Maps</a>
        
        <div class="card-actions">
          <button class="btn btn-view" onclick="viewDetails(1)">View Details</button>
          <button class="btn btn-download">⬇ Image</button>
          <button class="btn btn-delete" onclick="deleteSubmission(1)">Delete</button>
        </div>
      </div>

      <div class="submission-card" data-state="Rajasthan">
        <div class="card-header">
          <span class="card-id">#2</span>
          <span class="card-date">Oct 06, 2025</span>
        </div>
        
        <h3 class="spot-title">Amber Fort</h3>
        <div class="spot-location">
          <span class="location-badge">Rajasthan</span>
          <span class="location-badge">Jaipur</span>
        </div>
        
        <p class="spot-description">Magnificent fort overlooking Maota Lake. Famous for its artistic Hindu style elements and Sheesh Mahal. Light & sound show in evening is spectacular.</p>
        
        <div class="image-section">
          <div class="no-image">No image uploaded</div>
        </div>
        
        <div class="card-actions">
          <button class="btn btn-view" onclick="viewDetails(2)">View Details</button>
          <button class="btn btn-download">⬇ Image</button>
          <button class="btn btn-delete" onclick="deleteSubmission(2)">Delete</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for View Details -->
  <div class="modal" id="detailModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Submission Details</h2>
        <button class="modal-close" onclick="closeModal()">&times;</button>
      </div>
      
      <div id="modalBody">
        <div class="detail-row">
          <div class="detail-label">Submission ID</div>
          <div class="detail-value">#1</div>
        </div>
        
        <div class="detail-row">
          <div class="detail-label">Spot Name</div>
          <div class="detail-value">Statue of Unity</div>
        </div>
        
        <div class="detail-row">
          <div class="detail-label">State</div>
          <div class="detail-value">Gujarat</div>
        </div>
        
        <div class="detail-row">
          <div class="detail-label">District</div>
          <div class="detail-value">Vadodara</div>
        </div>
        
        <div class="detail-row">
          <div class="detail-label">Description</div>
          <div class="detail-value">The world's tallest statue at 182m, dedicated to Sardar Vallabhbhai Patel. Best visited during October-March. Entry fee: ₹120 for adults. Valley of Flowers and boat rides are must-visit attractions nearby.</div>
        </div>
        
        <div class="detail-row">
          <div class="detail-label">Image</div>
          <img src="placeholder.jpg" alt="Spot" class="modal-image" onerror="this.style.display='none'">
        </div>
        
        <div class="detail-row">
          <div class="detail-label">Google Maps Link</div>
          <div class="detail-value"><a href="https://maps.google.com" target="_blank" class="map-link">📍 Open in Maps</a></div>
        </div>
        
        <div class="detail-row">
          <div class="detail-label">Submitted On</div>
          <div class="detail-value">October 07, 2025</div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const stateFilter = document.getElementById('stateFilter');
    const submissionsGrid = document.getElementById('submissionsGrid');
    const resultCount = document.getElementById('resultCount');
    const detailModal = document.getElementById('detailModal');
    const backBtn = document.getElementById('backBtn');

    // Back button
    backBtn.addEventListener('click', (e)=>{
      e.preventDefault();
      if(history.length>1) history.back(); else window.location.href = '../index.html';
    });

    // Filter by state
    function filterSubmissions() {
      const selectedState = stateFilter.value;
      const cards = document.querySelectorAll('.submission-card');
      let visibleCount = 0;

      cards.forEach(card => {
        const cardState = card.getAttribute('data-state');
        if (selectedState === '' || cardState === selectedState) {
          card.style.display = 'flex';
          visibleCount++;
        } else {
          card.style.display = 'none';
        }
      });

      resultCount.textContent = `Showing ${visibleCount} submission${visibleCount !== 1 ? 's' : ''}`;
    }

    stateFilter.addEventListener('change', filterSubmissions);

    // Initialize count
    filterSubmissions();

    // View details modal
    function viewDetails(id) {
      // In PHP implementation, you would fetch data via AJAX or page reload
      // For now, just show the modal with demo data
      detailModal.classList.add('active');
      
      // Example AJAX call for PHP:
      /*
      fetch('get-submission.php?id=' + id)
        .then(response => response.json())
        .then(data => {
          // Populate modal with data
          document.getElementById('modalBody').innerHTML = generateModalContent(data);
          detailModal.classList.add('active');
        });
      */
    }

    function closeModal() {
      detailModal.classList.remove('active');
    }

    // Close modal on outside click
    detailModal.addEventListener('click', (e) => {
      if (e.target === detailModal) {
        closeModal();
      }
    });

    // Delete submission
    function deleteSubmission(id) {
      if (confirm('Are you sure you want to delete this submission? This action cannot be undone.')) {
        // In PHP implementation:
        /*
        fetch('delete-submission.php?id=' + id, { method: 'POST' })
          .then(response => response.json())
          .then(data => {
            if(data.success) {
              // Remove card from DOM
              document.querySelector(`[data-id="${id}"]`).remove();
              alert('Submission deleted successfully');
              filterSubmissions(); // Update count
            }
          });
        */
        
        // Demo: just remove from view
        alert('Delete functionality ready for PHP implementation');
        // In production, reload page or remove card after successful deletion
      }
    }

    // Close modal with Escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && detailModal.classList.contains('active')) {
        closeModal();
      }
    });
  </script>
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      fetchSubmissions();
      document.getElementById("stateFilter").addEventListener("change", fetchSubmissions);
    });

    function fetchSubmissions() {
      const state = document.getElementById("stateFilter").value;
      fetch(`fetch_submissions.php?state=${encodeURIComponent(state)}`)
        .then(res => res.text())
        .then(html => {
          document.getElementById("submissionsGrid").innerHTML = html;
          updateResultCount();
        })
        .catch(err => console.error("Error loading submissions:", err));
    }

    function updateResultCount() {
      const count = document.querySelectorAll(".submission-card").length;
      const resultCount = document.getElementById("resultCount");
      resultCount.textContent = count > 0 ? `${count} result${count > 1 ? 's' : ''}` : "No results found";
    }

    function viewDetails(id) {
      const modal = document.getElementById("detailModal");
      modal.classList.add("active");
      document.getElementById("modalBody").innerHTML = `<p style='text-align:center;'>Loading...</p>`;
      fetch(`fetch_submissions.php?id=${id}`)
        .then(res => res.text())
        .then(html => document.getElementById("modalBody").innerHTML = html)
        .catch(err => console.error("Error fetching details:", err));
    }

    function closeModal() {
      document.getElementById("detailModal").classList.remove("active");
    }

    function deleteSubmission(id) {
      if (!confirm("Are you sure you want to delete this submission?")) return;
      fetch(`delete_submission.php?id=${id}`)
        .then(res => res.text())
        .then(msg => {
          alert(msg);
          fetchSubmissions();
        })
        .catch(err => console.error("Error deleting submission:", err));
    }
  </script>

</body>
</html>